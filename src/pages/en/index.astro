---
import Layout from '../../layouts/Layout.astro';
import Header from '../../components/Header.astro';
import FolderView from '../../components/FolderView.astro';
import { getCollection } from 'astro:content';
import { buildFolderStructure } from '../../utils/folders';
import { SITE } from '../../site.config';

const allPosts = await getCollection('posts', ({ data }) => data.lang === 'en' && !data.draft);
const structure = buildFolderStructure(allPosts, '');

const alternates = {
  'zh-CN': new URL('/', SITE.domain).href,
  en: new URL('/en/', SITE.domain).href
};
---

<Layout lang="en" description="konakona's personal blog" alternates={alternates}>
  <script is:inline src="/scripts/lang-redirect-en.js"></script>
  <Header lang="en" toZh="/" toEn="/en/" />
  <main class="animate">
    <FolderView structure={structure} lang="en" />
  </main>
</Layout>
