---
import { getCollection } from 'astro:content';

export async function getStaticPaths() {
  const all = await getCollection('posts', ({ data }) => !data.draft);
  const slugs = new Set(all.filter(p => p.data.translationSlug).map(p => p.data.translationSlug));
  return Array.from(slugs).map((slug) => ({ params: { translationSlug: slug } }));
}

const { translationSlug } = Astro.params;
// Redirect /posts/* to /zh/posts/*
return Astro.redirect(`/zh/posts/${translationSlug}/`, 301);
---
